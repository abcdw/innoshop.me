{"version":3,"sources":["../src/shop.js"],"names":[],"mappings":"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","file":"shop.js","sourcesContent":["var actions = Reflux.createActions([\n    'addToBasket', 'decFromBasket', 'clearBusket'\n]);\n\nvar ProductStore = Reflux.createStore({\n    init: function() {\n        this.data = [];\n    },\n    setInitialState: function(products) {\n        this.data = products;\n    },\n    getInitialState: function() {\n        return this.data;\n    },\n    getProduct: function(id) {\n        return this.data[id];\n    },\n    add: function( product ) {\n        this.data[product.id] = product;\n    }\n});\n\nvar BasketStore = Reflux.createStore({\n    init: function() {\n        this.data = [];\n        this.listenTo(actions.addToBasket, this.onAddToBasket);\n        this.listenTo(actions.decFromBasket, this.onDecFromBasket);\n        this.listenTo(actions.clearBusket, this.onClearFromBasket);\n    },\n    initialize: function(url, get_url){\n        this.url = url;\n        var self = this;\n        $.get(get_url, function(res){\n            res = JSON.parse(res);\n            for(var i in res) {\n                ProductStore.add(res[i].product);\n                self.data[res[i].product.id] = res[i];\n            }\n            self.trigger( self.totalSum() );\n        })\n    },\n    onClearFromBasket: function() {\n        for(var i in this.data ) {\n            $.get( this.url + '?id=' + i + '&count=-' + this.data[i].count, function(res){  } );\n        }\n        this.data = [];\n        this.trigger( 0 );\n    },\n    onDecFromBasket: function(id, remove){\n        if( this.data[id] ) {\n            var cnt = remove ? this.data[id].count : 1;\n            this.data[id].count = this.data[id].count - cnt;\n            if( this.data[id].count <= 0 )\n                delete this.data[id];\n            $.get( this.url + '?id=' + id + '&count=-' + cnt, function(res){  } );\n            this.trigger( this.totalSum() );\n        }\n    },\n    onAddToBasket: function(id) {\n        if( this.data[id] ) {\n            this.data[id].count = this.data[id].count + 1;\n        }\n        else {\n            var product = ProductStore.getProduct(id);\n            if( product ) this.data[id] = { count: 1, product: product};\n        }\n        $.get( this.url + '?id=' + id + '&count=1', function(res){  } );\n        this.trigger( this.totalSum() );\n    },\n    totalSum: function() {\n        var total = 0;\n        for(var i in this.data)\n            total += this.data[i].count * this.data[i].product.price;\n        return total;\n    },\n    getInitialState: function() {\n        return this.data;\n    },\n    get: function(id){\n        return this.data[id];\n    },\n    items: function() {\n        return this.data;\n    },\n    getProductCount: function(id) {\n        return this.data[id] ? this.data[id].count : 0;\n    }\n});\n\nvar Price = React.createClass({\n    mixins: [Reflux.listenTo(BasketStore, \"onBasketChange\")],\n    onBasketChange: function(total) {\n        this.setProps({ count: BasketStore.getProductCount(this.props.id) });\n    },\n    onClick: function() {\n        actions.addToBasket(this.props.id);\n    },\n    render: function() {\n        var button_class = \"btn product__add \";\n        button_class += this.props.count > 0 ? \"btn-info\" : \"btn-default\";\n        var cnt = this.props.count > 0 ? ' [' + this.props.count + ']'  : '';\n        return (\n            <div className={button_class} onClick={this.onClick}>\n                <span className=\"product__price\">\n                    <i style={ { lineHeight: '8px' } } className=\"fa fa-plus\"></i>&nbsp;&nbsp;в карму</span>\n                    {cnt}\n            </div>\n        );\n    }\n});\n\nvar Basket = React.createClass({\n    mixins: [Reflux.listenTo(BasketStore, \"onBasketChange\")],\n    onBasketChange: function(total) {\n        this.setProps({ price: total });\n    },\n    onClick: function(event) {\n        event.preventDefault();\n        $('#basket-list').slideToggle();\n    },\n    render: function() {\n        var has_price = this.props.price > 0;\n        var basket_class = \"btn btn\" + (has_price ? '-success' : '-default');\n        var price = has_price ? <span className=\"basket__price\"> {this.props.price} <i className=\"fa fa-ruble\"></i></span> : '';\n        return (\n                <a href={this.props.url} onClick={this.onClick} className=\"basket\">\n                    <span className={basket_class}>\n                        <i className=\"fa fa-opencart\"></i> Карма\n                        { price }\n                    </span>\n                </a>\n        );\n    }\n});\n\nvar BasketLine = React.createClass({\n    add: function() {\n        actions.addToBasket(this.props.product.id);\n    },\n    dec: function() {\n        actions.decFromBasket(this.props.product.id);\n    },\n    remove: function() {\n        actions.decFromBasket(this.props.product.id, true);\n    },\n    render: function() {\n        var sum = this.props.product.price * this.props.count;\n        var min_count = this.props.product.min_count > 1 ? (<sup className=\"text-info\">{this.props.product.min_count}</sup>) : '';\n        return (<div className=\"row basket-list__line\">\n                    <div className=\"col-xs-2 col-sm-1 col-md-1 col-lg-1 text-right\">\n                        <div className=\"btn  btn-default\" onClick={this.add}><i className=\"fa fa-plus\"></i></div>\n                    </div>\n                    <div className=\"col-xs-2 col-sm-1 col-md-1 col-lg-1\">\n                        <div className=\"btn  btn-default\" onClick={this.dec}><i className=\"fa fa-minus\"></i></div>\n                    </div>\n                    <div className=\"h4 col-xs-2 col-sm-1 col-md-1 col-lg-1\">\n                        {this.props.count}&nbsp;{min_count}\n                    </div>\n                    <div className=\"hidden-xs visible-sm col-sm-8 visible-md col-md-8 visible-lg col-lg-8\">\n                        <span dangerouslySetInnerHTML={{__html: this.props.product.name}} />\n                        <sup className=\"text-danger\" style={ { whiteSpace: 'nowrap' } }> {this.props.product.price} <i className=\"fa fa-ruble\"></i></sup>\n                    </div>\n                    <div className=\"h4 col-xs-6 col-sm-1 col-md-1 col-lg-1 text-right\">\n                        {sum}&nbsp;<i className=\"fa fa-ruble\" />\n                    </div>\n                    <div className=\"col-xs-12 visible-xs hidden-sm hidden-md hidden-lg\">\n                        <span dangerouslySetInnerHTML={{__html: this.props.product.name}} />\n                        <sup className=\"text-danger\" style={ { whiteSpace: 'nowrap' } }> {this.props.product.price} <i className=\"fa fa-ruble\"></i></sup>\n                    </div>\n                </div>\n            )\n    }\n});\n\nvar BasketList = React.createClass({\n    mixins: [Reflux.listenTo(BasketStore, \"onBasketChange\")],\n    onBasketChange: function(total) {\n        this.setProps({ items: BasketStore.items(), total: BasketStore.totalSum() });\n    },\n    onClose: function() {\n        $(this.getDOMNode()).parents('#basket-list').slideToggle();\n    },\n    clearBusket: function(){\n        actions.clearBusket();\n    },\n    render: function() {\n        var self = this;\n        var items = this.props.items;\n        var list = items ?\n            items.map( function( item ){ item.key = item.product.id; return (<BasketLine {...item} />); })\n            : '';\n        var btn = this.props.link ?\n                    (<button type=\"submit\" target=\"orderForm\" className=\"btn btn-success\" href={this.props.link} alt=\"Потратить карму\">\n                        <i className=\"fa fa-shopping-cart\" />&nbsp;&nbsp;Потратить\n                    </button>)\n                    : '';\n        var btn_cear = this.props.items ? (<div className=\"btn btn-danger\"><i className=\"fa fa-trash-o\"></i>&nbsp;&nbsp;Очистить</div>) : '';\n        var form = this.props.link ? (\n            <div><br></br>\n                <div className=\"form-group\">\n                    <input type=\"text\" id=\"contact\" name=\"contact\" className=\"form-control\"\n                           placeholder=\"@telegram или номер телефона\"></input>\n                </div>\n                <div className=\"form-group\">\n                    <textarea name=\"comment\" id=\"comment\" cols=\"30\" rows=\"3\" placeholder=\"Комментарий\"\n                              className=\"form-control\" ></textarea>\n                </div>\n            </div>\n        ) :'';\n        var csrf = this.props.csrf_token ? (<input type=\"hidden\" name=\"csrfmiddlewaretoken\" value={this.props.csrf_token}></input>) : '';\n        return (items || this.props.link) ? (\n           <div className=\"basket-list\">\n                <form action={this.props.link} id=\"orderForm\" method=\"POST\">\n                    {csrf}\n                    <div className=\"panel panel-default\">\n                      <div className=\"panel-body\">\n                        <div className=\"container-fluid\">{list}</div>\n                        {form}\n                      </div>\n                      <div className=\"panel-footer\">\n                          <div className=\"row\">\n                            <span className=\"h3 col-xs-12 col-sm-8 col-md-8 col-lg-8\">Ваша карма {this.props.total} <i className=\"fa fa-ruble\"></i></span>\n                            <div className=\"h3 col-xs-12 col-sm-4 col-md-4 col-lg-4\">\n                                <div className=\"btn-group pull-right\">{ btn } { btn_cear }\n                                    <div onClick={this.onClose} className=\"btn btn-default\"><i className=\"fa fa-close\"></i>&nbsp;&nbsp;Закрыть</div></div>\n                                </div>\n                          </div>\n                      </div>\n                    </div>\n                </form>\n           </div>\n        ) : '';\n    }\n});\n"]}